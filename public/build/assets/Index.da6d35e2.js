import{p as T}from"./pickBy.bd80f484.js";import{t as F}from"./throttle.7e7db953.js";import{S,m as N}from"./SearchFilter.6af03689.js";import{L}from"./Layout.c268843b.js";import{M as $}from"./Modal.44e047a5.js";import{B as D}from"./Button.49cfcc8c.js";import{S as I}from"./SmsDialog.bc6d4fbe.js";import{P as O}from"./Pagination.cc1280e3.js";import E from"./Form.ee5c5a57.js";import R from"./MeasurementModal.25fe218f.js";import{_ as U,r as a,o as i,c as u,a as t,t as l,b as n,w as c,F as q,g as z,e as h,d as b,k as _,f as w}from"./app.d8289e67.js";import"./debounce.9b400763.js";import"./Dropdown.48a14283.js";import"./FlashMessages.3029884e.js";import"./LoadingButton.323ea2dd.js";import"./TextareaInput.1737678e.js";import"./InputError.b5dfb222.js";import"./TextInput.f4f909b7.js";import"./Input.954bfb09.js";import"./CheckboxInput.0509202e.js";const A={layout:L,components:{Pagination:O,SearchFilter:S,SmsDialog:I,Modal:$,PaymentForm:E,Button:D,MeasurementModal:R},props:{customers:Object,filters:Object},metaInfo(){return{title:this.$tc("Customer",2)}},data(){return{form:{search:this.filters.search,trashed:this.filters.trashed},viewsms:!1,view:!1,viewMeasure:!1,order:{},customer:{},measurement:null,customer_id:0}},watch:{form:{handler:F(function(){let e=T(this.form);this.$inertia.replace(this.route("customers",Object.keys(e).length?e:{remember:"forget"}))},250),deep:!0}},methods:{smsToCustomer(e){this.order.customer=e,this.viewsms=!0},journalTransactions(e){this.$inertia.visit(this.route("customers.transactions",e))},rowClicked(e){this.$inertia.visit(this.route("customers.edit",e))},reset(){this.form=N(this.form,()=>null)},addPayment(e){this.customer={value:e.id,label:e.name},this.view=!0},showMeasureModal(e){this.measurement=this.customers.data.find(r=>r.id===e).customer_measure,this.viewMeasure=!0,this.customer_id=e}}},W={class:"mb-6 mt-2 font-bold text-lg md:text-2xl"},G={class:"np mb-6 flex justify-between items-center"},H={class:"block text-gray-700"},J={class:"inline md:hidden"},K={class:"hidden md:inline"},Q={class:"bg-white rounded shadow overflow-x-auto scroll-on-light"},X={class:"w-full whitespace-no-wrap"},Y={class:"text-left font-bold"},Z={class:"px-6 pt-6 pb-4"},ee={class:"px-6 pt-6 pb-4"},te={class:"px-6 pt-6 pb-4"},se={class:"px-6 pt-6 pb-4"},oe={class:"px-6 pt-6 pb-4"},re={class:"px-6 pt-6 pb-4",colspan:"2"},le=["onClick"],ne={class:"border-t px-6 py-4"},ae={class:"flex items-center"},ie=["onClick"],me={class:"border-t px-6 py-4"},de={class:"flex items-center"},ce=["onClick"],ue={class:"border-t px-6 py-4"},he={class:"border-t px-6 py-4 font-bold"},pe={class:"flex items-center justify-end"},fe=["onClick"],_e={class:"border-t px-6 py-4 max-w-lg truncate"},we={class:"border-t px-6 py-4 max-w-lg truncate"},ve={class:"border-t px-6 py-4 w-8"},be={key:0},ye={class:"border-t px-6 py-4",colspan:"7"};function ke(e,r,p,xe,o,m){const x=a("v-select"),g=a("search-filter"),d=a("Icons"),C=a("Link"),M=a("Button"),V=a("pagination"),B=a("SmsDialog"),v=a("Modal"),j=a("PaymentForm"),P=a("MeasurementModal");return i(),u("div",null,[t("div",null,[t("h1",W,l(e.$tc("Customer",2)),1),t("div",G,[n(g,{modelValue:o.form.search,"onUpdate:modelValue":r[1]||(r[1]=s=>o.form.search=s),class:"w-full max-w-md ltr:mr-4 rtl:ml-4",onReset:m.reset},{default:c(()=>[t("label",H,l(e.$t("Trashed")),1),n(x,{modelValue:o.form.trashed,"onUpdate:modelValue":r[0]||(r[0]=s=>o.form.trashed=s),options:[{value:"",label:"Not Trashed"},{value:"with",label:e.$t("With Trashed")},{value:"only",label:e.$t("Only Trashed")}],reduce:s=>s.value},null,8,["modelValue","options","reduce"])]),_:1},8,["modelValue","onReset"]),n(C,{class:"btn-gray",href:e.route("customers.create")},{default:c(()=>[t("span",J,[n(d,{name:"add",class:"w-4 h-4 text-white fill-white group-hover:text-white fill-white"})]),t("span",K,l(e.$t("create_x",{x:e.$tc("Customer")})),1)]),_:1},8,["href"])]),t("div",Q,[t("table",X,[t("thead",null,[t("tr",Y,[t("th",Z,l(e.$t("Name")),1),t("th",ee,l(e.$t("Phone")),1),t("th",te,l(e.$t("Email")),1),t("th",se,l(e.$t("Balance")),1),t("th",oe,l(e.$t("Address")),1),t("th",re,l(e.$t("Measure")),1)])]),t("tbody",null,[(i(!0),u(q,null,z(p.customers.data,s=>{var y,k;return i(),u("tr",{key:s.id,onClick:f=>m.rowClicked(s.id),class:"cursor-pointer hover:bg-teal-200 focus-within:bg-teal-200"},[t("td",ne,[t("div",ae,[t("a",{onClick:_(f=>m.journalTransactions(s.id),["stop"]),class:"text-gray-700 hover:text-gray-800"},[n(d,{name:"journal",class:"flex-shrink-0 w-4 h-4 fill-current ltr:mr-2 rtl:ml-2"})],8,ie),w(" "+l(s.name)+" ",1),s.deleted_at?(i(),b(d,{key:0,name:"trash",class:"flex-shrink-0 w-3 h-3 fill-gray-400 ml-2"})):h("",!0)])]),t("td",me,[t("div",de,[w(l(s.phone)+" ",1),e.$page.props.user.account.sms_enabled&&(e.$page.props.user.can_sms||e.$page.props.user.owner)?(i(),u("a",{key:0,onClick:_(f=>m.smsToCustomer(s),["stop"]),class:"modal-close ml-2 cursor-pointer text-gray-700 hover:text-gray-800"},[n(d,{name:"sms",class:"h-4 w-4 fill-current"})],8,ce)):h("",!0)])]),t("td",ue,l(s.email),1),t("td",he,[t("div",pe,[w(l(e.$number((k=(y=s==null?void 0:s.journal)==null?void 0:y.balance)==null?void 0:k.amount))+" ",1),t("a",{onClick:_(f=>m.addPayment(s),["stop"]),class:"p-1 text-green-700"},[n(d,{name:"add",class:"flex-shrink-0 w-3 h-3 fill-current ml-2"})],8,fe)])]),t("td",_e,l(s.address),1),t("td",we,[n(M,{type:"button",size:"xs",color:"red",onClick:_(f=>m.showMeasureModal(s.id),["stop"])},{default:c(()=>[w(l(e.$t("Edit")),1)]),_:2},1032,["onClick"])]),t("td",ve,[n(d,{name:"cheveron-right",class:"block w-6 h-6 fill-gray-400 rtl:rotate"})])],8,le)}),128)),p.customers.data.length===0?(i(),u("tr",be,[t("td",ye,l(e.$t("no_x_found",{x:e.$tc("Customer")})),1)])):h("",!0)])])]),n(V,{links:p.customers.links,meta:p.customers.meta},null,8,["links","meta"])]),o.viewsms?(i(),b(v,{key:0,show:o.viewsms,"max-width":"2xl",closeable:!0,onClose:r[3]||(r[3]=s=>o.viewsms=!1)},{default:c(()=>[n(B,{order:o.order,onClose:r[2]||(r[2]=()=>o.viewsms=!1)},null,8,["order"])]),_:1},8,["show"])):h("",!0),o.view?(i(),b(v,{key:1,show:o.view,"max-width":"2xl",closeable:!0,onClose:r[5]||(r[5]=s=>o.view=!1)},{default:c(()=>[n(j,{c:o.customer,modal:!0,onClose:r[4]||(r[4]=()=>o.view=!1)},null,8,["c"])]),_:1},8,["show"])):h("",!0),n(v,{show:o.viewMeasure,"max-width":"3xl",onClose:r[7]||(r[7]=()=>o.viewMeasure=!1)},{default:c(()=>[n(P,{customer_id:o.customer_id,measurement:o.measurement,onClose:r[6]||(r[6]=()=>o.viewMeasure=!1)},null,8,["customer_id","measurement"])]),_:1},8,["show"])])}const ze=U(A,[["render",ke]]);export{ze as default};
